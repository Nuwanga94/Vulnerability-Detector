package VulDetect;


import java.io.*;
import weka.classifiers.trees.RandomForest;
import weka.core.*;



public class Detect {
	private static RandomForest Detect;

	public double[] bb;
	public double[] bug;
	
	  public Detect() {
		  test();
	  }
	  
	  private void test() {		  
		  try {
			  	 // take the model
		         RandomForest cls = (RandomForest) weka.core.SerializationHelper.read("model.model");


		         Instances unlabeled = new Instances(
		                                 new BufferedReader(
		                                   new FileReader("data.arff")));

		         // set class attribute
		         unlabeled.setClassIndex(unlabeled.numAttributes() - 1);

		         // create copy
		         Instances labeled = new Instances(unlabeled);
		         
		         
		         int[] bug = new int[unlabeled.numInstances()];
		         bb = new double[unlabeled.numInstances()]; 
		         
		         // label instances
		         for (int i = 0; i < unlabeled.numInstances(); i++) {
		        	 
//		        	  System.out.println(labeled.instance(i).classValue());
			          System.out.print("dummy: " + labeled.classAttribute().value((int)labeled.instance(i).classValue()));
			             
		           
			          double clsLabel = cls.classifyInstance(unlabeled.instance(i));
			          labeled.instance(i).setClassValue(clsLabel);
			          System.out.println(", -> predicted: " + labeled.classAttribute().value((int) clsLabel)); //wrong

		           
			          bug[i] = (int) Double.parseDouble(unlabeled.classAttribute().value((int)clsLabel));
			          i++;
		         }
		         	    
		         
		         for (int i = 0; i < bug.length; i++) {
		        	  bb[i] = bug[i];
		        	}	        		        
//		         for (int i = 0; i < bb.length; i++) {
//		        	  System.out.println(bb[i]);
//		        	
//		        	}
		                
		           
		        
			} catch (Exception e) {
				System.out.println(e.getMessage());
			}
		}
}